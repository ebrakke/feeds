import{f as _,a as o,c as O,t as oe,b as Le}from"../chunks/CMYthPH1.js";import{o as Fe,a as Te}from"../chunks/BTvDARnc.js";import{C as qe,H as G,e as ze,I as Ue,aa as je,ab as Ae,ac as Re,K as Ve,p as We,s as p,a as Be,t as I,b as De,i as Ee,h as y,c as d,d as i,g as a,u as He,$ as Pe,r as v,f as J,n as Ye}from"../chunks/DRd13Xrb.js";import{d as Ke,s as R,e as Q}from"../chunks/B-oMrjzJ.js";import{i as w}from"../chunks/B-ckIuUA.js";import{g as Ne,o as Oe,s as X,e as Ge,i as Je,u as ie,p as Qe}from"../chunks/BCt0s9Jx.js";import{h as Xe}from"../chunks/DmEoDL_F.js";import{b as Ze}from"../chunks/DdLWTTLn.js";import{s as $e,a as ea}from"../chunks/4vFQ4oUl.js";import{p as aa}from"../chunks/DCm6qz_f.js";function ne(r,n,L=!1){if(r.multiple){if(n==null)return;if(!je(n))return Ae();for(var m of r.options)m.selected=n.includes(j(m));return}for(m of r.options){var k=j(m);if(Re(k,n)){m.selected=!0;return}}(!L||n!==void 0)&&(r.selectedIndex=-1)}function ta(r){var n=new MutationObserver(()=>{ne(r,r.__value)});n.observe(r,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["value"]}),Ve(()=>{n.disconnect()})}function ra(r,n,L=n){var m=new WeakSet,k=!0;qe(r,"change",l=>{var g=l?"[selected]":":checked",h;if(r.multiple)h=[].map.call(r.querySelectorAll(g),j);else{var C=r.querySelector(g)??r.querySelector("option:not([disabled])");h=C&&j(C)}L(h),G!==null&&m.add(G)}),ze(()=>{var l=n();if(r===document.activeElement){var g=Ue??G;if(m.has(g))return}if(ne(r,l,k),k&&l===void 0){var h=r.querySelector(":checked");h!==null&&(l=j(h),L(l))}r.__value=l,k=!1}),ta(r)}function j(r){return"__value"in r?r.__value:r.value}var sa=_('<div class="absolute inset-0 flex items-center justify-center bg-gray-900"><div class="text-center"><svg class="animate-spin h-10 w-10 text-blue-500 mx-auto mb-3" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg> <p class="text-gray-400 text-sm">Loading video...</p></div></div>'),oa=_('<div class="absolute inset-0 flex items-center justify-center bg-gray-900"><div class="text-center px-4"><svg class="h-10 w-10 text-red-500 mx-auto mb-3" fill="none" stroke="currentColor" viewBox="0 0 24 24"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"></path></svg> <p class="text-red-400 mb-2"> </p> <a target="_blank" rel="noopener" class="text-blue-400 hover:text-blue-300 text-sm">Watch on YouTube instead</a></div></div>'),ia=_('<video class="w-full h-full" controls playsinline="">Your browser does not support the video tag.</video>',2),na=_('<span class="inline-block bg-gray-700 rounded h-6 w-64 animate-pulse"></span>'),la=_('<span class="inline-block bg-gray-700 rounded h-4 w-32 animate-pulse"></span>'),ca=_('<span class="text-green-400 text-sm">Subscribed!</span>'),da=_("<option> </option>"),va=Le('<svg class="animate-spin h-3 w-3" fill="none" viewBox="0 0 24 24"><circle class="opacity-25" cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4"></circle><path class="opacity-75" fill="currentColor" d="M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"></path></svg>'),ua=_('<div class="flex items-center gap-2"><select class="bg-gray-800 border border-gray-700 rounded px-2 py-1 text-sm"><option disabled>Add to...</option><!></select> <button class="bg-red-600 hover:bg-red-700 disabled:opacity-50 text-white px-3 py-1 rounded text-sm inline-flex items-center gap-1"><!> Subscribe</button></div>'),fa=_('<a href="/import" class="text-sm text-blue-400 hover:text-blue-300">Create a feed to subscribe</a>'),pa=_('<div class="max-w-4xl mx-auto"><div class="aspect-video bg-black rounded-lg overflow-hidden mb-4 relative"><!></div> <h1 class="text-lg font-bold mb-2"><!></h1> <div class="flex items-center justify-between mb-4"><p class="text-gray-400"><!></p> <div><!></div></div> <a target="_blank" rel="noopener" class="text-sm text-gray-500 hover:text-blue-400">Watch on YouTube</a></div>');function Sa(r,n){We(n,!0);const L=()=>ea(aa,"$page",m),[m,k]=$e();let l=He(()=>L().params.id),g=p(""),h=p(""),C=p(""),Z=p(""),$=p(0),T=p(Be([])),q=p(!0),V=p(null),A=p(!1),W=p(!1),F=p(""),u=null,ee=0;Fe(async()=>{try{i(T,await Ne(),!0);const e=a(T).find(t=>t.is_system);e&&i(F,e.id.toString(),!0)}catch(e){console.warn("Failed to load feeds:",e)}try{const e=await Oe(a(l));i(g,e.title,!0),i(h,e.channel,!0),i(C,e.channelURL,!0),i(Z,e.streamURL,!0),i($,e.existingChannelID,!0),a($)>0&&i(W,!0)}catch(e){i(V,e instanceof Error?e.message:"Failed to load video",!0)}finally{i(q,!1)}}),Te(()=>{u&&(ae(),u.pause())});function le(){u&&u.play().catch(()=>{})}function ae(){if(!u)return;const e=Math.floor(u.currentTime),t=Math.floor(u.duration)||0;Math.abs(e-ee)>=5&&t>0&&(ee=e,ie(a(l),e,t).catch(()=>{}))}function ce(){ae()}function de(){if(!u)return;const e=Math.floor(u.currentTime),t=Math.floor(u.duration)||0;t>0&&ie(a(l),e,t).catch(()=>{})}async function ve(){if(!(!a(F)||!a(C))){i(A,!0);try{await Qe(parseInt(a(F)),a(C)),i(W,!0)}catch(e){console.error("Failed to subscribe:",e),alert(e instanceof Error?e.message:"Failed to subscribe")}finally{i(A,!1)}}}var B=pa();Xe("1oiicp0",e=>{Ee(()=>{Pe.title=`${(a(g)||"Watch")??""} - Feeds`})});var D=d(B),ue=d(D);{var fe=e=>{var t=sa();o(e,t)},pe=e=>{var t=O(),Y=J(t);{var K=c=>{var s=oa(),f=d(s),b=y(d(f),2),S=d(b,!0);v(b);var x=y(b,2);v(f),v(s),I(()=>{R(S,a(V)),X(x,"href",`https://www.youtube.com/watch?v=${a(l)??""}`)}),o(c,s)},N=c=>{var s=ia();Ze(s,f=>u=f,()=>u),I(()=>X(s,"src",a(Z))),Q("loadeddata",s,le),Q("timeupdate",s,ce),Q("pause",s,de),o(c,s)};w(Y,c=>{a(V)?c(K):c(N,!1)},!0)}o(e,t)};w(ue,e=>{a(q)?e(fe):e(pe,!1)})}v(D);var E=y(D,2),me=d(E);{var _e=e=>{var t=na();o(e,t)},he=e=>{var t=oe();I(()=>R(t,a(g))),o(e,t)};w(me,e=>{a(q)?e(_e):e(he,!1)})}v(E);var H=y(E,2),P=d(H),be=d(P);{var ge=e=>{var t=la();o(e,t)},xe=e=>{var t=oe();I(()=>R(t,a(h))),o(e,t)};w(be,e=>{a(q)?e(ge):e(xe,!1)})}v(P);var te=y(P,2),ye=d(te);{var we=e=>{var t=ca();o(e,t)},ke=e=>{var t=O(),Y=J(t);{var K=c=>{var s=ua(),f=d(s),b=d(f);b.value=b.__value="";var S=y(b);Ge(S,17,()=>a(T),Je,(M,z)=>{var U=da(),Ie=d(U,!0);v(U);var re={};I(se=>{R(Ie,a(z).is_system?"Inbox (default)":a(z).name),re!==(re=se)&&(U.value=(U.__value=se)??"")},[()=>a(z).id.toString()]),o(M,U)}),v(f);var x=y(f,2);x.__click=ve;var Se=d(x);{var Me=M=>{var z=va();o(M,z)};w(Se,M=>{a(A)&&M(Me)})}Ye(),v(x),v(s),I(()=>x.disabled=a(A)||!a(F)),ra(f,()=>a(F),M=>i(F,M)),o(c,s)},N=c=>{var s=O(),f=J(s);{var b=S=>{var x=fa();o(S,x)};w(f,S=>{a(T).length===0&&!a(q)&&S(b)},!0)}o(c,s)};w(Y,c=>{a(C)&&a(T).length>0?c(K):c(N,!1)},!0)}o(e,t)};w(ye,e=>{a(W)?e(we):e(ke,!1)})}v(te),v(H);var Ce=y(H,2);v(B),I(()=>X(Ce,"href",`https://www.youtube.com/watch?v=${a(l)??""}`)),o(r,B),De(),k()}Ke(["click"]);export{Sa as component};
